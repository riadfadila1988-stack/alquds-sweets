import {createContext, useContext, useMemo, useState, ReactNode, createElement} from 'react';

// Minimal, local i18n implementation to avoid external dependency on react-i18next
// Extend translations as needed.
const resources = {
    ar: {
        // Common
        login: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        // New screens: employees hours
        employeesHoursTitle: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø´Ù‡Ø±ÙŠØ©',
        prevMonth: 'Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚',
        nextMonth: 'Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ',
        selectMonth: 'Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±',
        noEmployeesData: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¸ÙÙŠÙ†',
        // New labels for employees hours row
        worked: 'Ø¹Ù…Ù„',
        of: 'Ù…Ù†',
        days: 'Ø£ÙŠØ§Ù…',
        // Materials form translations
        addMaterial: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©',
        name: 'Ø§Ù„Ø§Ø³Ù…',
        quantity: 'Ø§Ù„ÙƒÙ…ÙŠØ©',
        minQuantity: 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ÙƒÙ…ÙŠØ©',
        hebrewName: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø¨Ø±ÙŠ',
        cost: 'Ø§Ù„ØªÙƒÙ„ÙØ©',
        // Label for last-updated datetime
        updated: 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«',
        selectUnit: 'Ø§Ø®ØªØ± Ø§Ù„ÙˆØ­Ø¯Ø©',
        selectMaterial: 'Ø§Ø®ØªØ± Ù…Ø§Ø¯Ø©',
        searchMaterials: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆØ§Ø¯',
        materialGroups: 'Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¯',
        addMaterialToGroup: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø©',
        // Materials list button/label
        materialsList: 'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯',
        // Added translations for update-material-quantity screen
        updateMaterialsQuantity: 'ØªØ­Ø¯ÙŠØ« ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ø¯',
        accessDenied: 'ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„. ÙŠÙ‚ØªØµØ± Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†.',
        invalidQuantity: 'Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­Ø©',
        failedToSave: 'ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ÙƒÙ…ÙŠØ©',
        saved: 'ØªÙ… Ø§Ù„Ø­ÙØ¸',
        // Saving status
        saving: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...',
        cancel: 'Ø¥Ù„ØºØ§Ø¡',
        add: 'Ø¥Ø¶Ø§ÙØ©',
        nameRequired: 'Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨',
        hebrewNameRequired: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø¨Ø±ÙŠ Ù…Ø·Ù„ÙˆØ¨',
        costRequired: 'Ø§Ù„ØªÙƒÙ„ÙØ© Ù…Ø·Ù„ÙˆØ¨Ø©',
        failedToCreateMaterial: 'ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø©',
        low: 'Ù…Ù†Ø®ÙØ¶',
        unit_kg: 'ÙƒØ¬Ù…',
        unit_g: 'Øº',
        unit_pcs: 'Ù‚Ø·Ø¹Ø©',
        unit_ltr: 'Ù„ØªØ±',
        unit_pack: 'Ø¹Ø¨ÙˆØ©',
        unit_m: 'Ù…ØªØ±',
        // Notifications/modal
        notifications: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª',
        markAllRead: 'ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡',
        markRead: 'ÙˆØ¶Ø¹ ÙƒÙ…Ù‚Ø±ÙˆØ¡',
        close: 'Ø¥ØºÙ„Ø§Ù‚',
        // Edit/Delete
        noMaterialsData: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯',
        editMaterial: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø©',
        save: 'Ø­ÙØ¸',
        delete: 'Ø­Ø°Ù',
        deleteConfirm: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©ØŸ',
        employeeDetailsTitle: 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù',
        noWorkDays: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙŠØ§Ù… Ø¹Ù…Ù„',
        startTime: 'ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡',
        endTime: 'ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡',
        sunday: 'Ø§Ù„Ø£Ø­Ø¯',
        monday: 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†',
        tuesday: 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',
        wednesday: 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',
        thursday: 'Ø§Ù„Ø®Ù…ÙŠØ³',
        friday: 'Ø§Ù„Ø¬Ù…Ø¹Ø©',
        saturday: 'Ø§Ù„Ø³Ø¨Øª',
        idNumber: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©',
        password: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        hide: 'Ø¥Ø®ÙØ§Ø¡',
        show: 'Ø¥Ø¸Ù‡Ø§Ø±',
        loginButton: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        loginError: 'Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        adminDashboard: 'Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±',
        employeeDashboard: 'Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ¸Ù',
        workingHours: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„',
        clockIn: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        clockOut: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
        currentStatus: 'Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©',
        clockedIn: 'Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        clockedOut: 'Ù…Ø³Ø¬Ù„ Ø§Ù„Ø®Ø±ÙˆØ¬',
        logout: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
        confirmLogout: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ',
        workingHoursToday: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…',
        totalHours: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª',
        workHistory: 'Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„',
        noWorkHistory: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø¹Ù…Ù„',
        loading: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...',
        clockedInAt: 'Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø©:',
        confirmClockOut: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ',
        back: 'Ø±Ø¬ÙˆØ¹',
        error: 'Ø®Ø·Ø£',
        failedToClockIn: 'ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        failedToClockOut: 'ÙØ´Ù„ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
        stillWorking: 'Ù…Ø§ Ø²Ø§Ù„ ÙŠØ¹Ù…Ù„',
        in: 'Ø¯Ø®ÙˆÙ„:',
        out: 'Ø®Ø±ÙˆØ¬:',
        // Back to groups (used in update-material-quantity screen)
        backToGroups: 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª',

        // Work Status screen
        workStatus: 'Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù…Ù„',
        noOneWorking: 'Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø£ÙŠ Ù…ÙˆØ¸Ù Ø­Ø§Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ù….',
        startedAt: 'Ø¨Ø¯Ø£ ÙÙŠ',
        assignedDuration: 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©',
        elapsed: 'Ù…Ù†Ù‚Ø¶Ù‰',

        // Add User screen
        confirmPassword: 'ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        role: 'Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ÙˆØ¸ÙŠÙÙŠ',
        employee: 'Ù…ÙˆØ¸Ù',
        admin: 'Ù…Ø¯ÙŠØ±',
        active: 'Ù†Ø´Ø·',
        addUser: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…',
        addNewUser: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯',
        addUserSubtitle: 'Ù‚Ù… Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù…Ø³ØªØ®Ø¯Ù…',
        // Password change labels/messages
        newPassword: 'ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©',
        passwordHelp: 'Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 6 Ø£Ø­Ø±Ù.',
        passwordMinLength: 'ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
        passwordsDoNotMatch: 'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†',
        // Users list / management
        manageUsers: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
        edit: 'ØªØ¹Ø¯ÙŠÙ„',
        userListSubtitle: 'Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
        editUser: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        // Placeholders and messages used by add-user.tsx
        enterUserName: 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…',
        enterIdNumber: 'Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©',
        enterPassword: 'Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        reEnterPassword: 'Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        success: 'Ù†Ø¬Ø§Ø­',
        userAddedSuccessfully: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­',
        ok: 'Ù…ÙˆØ§ÙÙ‚',
        failedToAddUser: 'ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        passwordsNotMatch: 'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†',
        userCanLoginImmediately: 'ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙˆØ±Ø§Ù‹',
        userCannotLogin: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',

        // Validation messages
        idNumberRequired: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ù…Ø·Ù„ÙˆØ¨',
        idNumberMin: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
        passwordRequired: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø·Ù„ÙˆØ¨Ø©',
        passwordMin: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
        materialsManagement: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¯',

        // Task Groups
        taskGroups: 'Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù…',
        groupName: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©',
        tasks: 'Ø§Ù„Ù…Ù‡Ø§Ù…',
        taskName: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø©',
        durationInMinutes: 'Ø§Ù„Ù…Ø¯Ø© (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)',
        startAt: 'ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø¡',
        description: 'Ø§Ù„ÙˆØµÙ',
        usedMaterials: 'Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©',
        producedMaterials: 'Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø©',
        addMaterialToTask: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ù„Ù„Ù…Ù‡Ù…Ø©',
        removeMaterialFromTask: 'Ø¥Ø²Ø§Ù„Ø© Ù…Ø§Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ù‡Ù…Ø©',
        addTask: 'Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©',
        removeTask: 'Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø©',
        submit: 'Ø¥Ø±Ø³Ø§Ù„',
        noTaskGroups: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù…Ù‡Ø§Ù… Ø¨Ø¹Ø¯',
        noTaskGroup: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ù‡Ø§Ù…',
        errorFetchingData: 'Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
        remove: 'Ø¥Ø²Ø§Ù„Ø©',
        newTaskGroup: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù‡Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø©',
        // New material group screen title
        newMaterialGroup: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©',
        planWorkDay: 'ØªØ®Ø·ÙŠØ· ÙŠÙˆÙ… Ø§Ù„Ø¹Ù…Ù„',
        change: 'ØªØºÙŠÙŠØ±',
        set: 'ØªØ¹ÙŠÙŠÙ†',
        employees: 'Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
        assignments: 'Ø§Ù„Ù…Ù‡Ø§Ù…',
        noEmployeesSelected: 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…ÙˆØ¸Ù',
        savePlan: 'Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø©',
        previousDay: 'Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø³Ø§Ø¨Ù‚',
        nextDay: 'Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ',
        selectDate: 'Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®',
        // Today tasks screen title
        todayTasks: 'Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…',
        // Today tasks screen strings
        noTasksToday: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….',
        start: 'Ø§Ø¨Ø¯Ø£',
        end: 'Ø¥Ù†Ù‡Ø§Ø¡',
        untitledTask: 'Ù…Ù‡Ù…Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†',
        overrunTitle: 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø®Ø·Ø·',
        overrunPrompt: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¨Ø¨ Ù…ÙˆØ¬Ø² Ù„Ø²ÙŠØ§Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„Ù…Ù‡Ù…Ø©:',
        overrunPlaceholder: 'Ù…Ø«Ø§Ù„: Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙƒÙˆÙ†Ø§ØªØŒ ØªØ¹Ø·Ù„ Ø§Ù„Ù…Ø§ÙƒÙŠÙ†Ø©',
        notificationSent: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ£Ø®ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†',
        notificationFailed: 'ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±',
        failedToSaveTaskTimes: 'ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù…',
        planSaved: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø©',
        noResults: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬',
        clear: 'Ø¥ØºÙ„Ø§Ù‚ÙŠ',
        // Welcome overlay
        welcomeBackMain: 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒØŒ',
        welcomeBackSub: 'Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ø¬Ø¹Ù„ Ø§Ù„ÙŠÙˆÙ… Ø±Ø§Ø¦Ø¹Ù‹Ø§ØŸ Ù‡ÙŠØ§ Ø¨Ù†Ø§! ðŸŽ‰',
        // Tasks statistics translations
        'tasksStatistics.title': 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù‡Ø§Ù…',
        'tasksStatistics.assigned': 'Ù…ÙØ¹ÙŠÙ‘Ù†',
        'tasksStatistics.doneOnTime': 'Ù…Ù†Ø¬Ø² ÙÙŠ Ø§Ù„ÙˆÙ‚Øª',
        'tasksStatistics.late': 'Ù…ØªØ£Ø®Ø±',
        'tasksStatistics.incomplete': 'ØºÙŠØ± Ù…ÙƒØªÙ…Ù„',
        'tasksStatistics.lateShort': 'ØªØ£Ø®ÙŠØ±',
        'tasksStatistics.completed': 'Ù…ÙƒØªÙ…Ù„',
        'tasksStatistics.averageDuration': 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©',
        'tasksStatistics.duration': 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©',
        'tasksStatistics.totalTasks': 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…',
        'tasksStatistics.timesAssigned': 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©',
        'tasksStatistics.timesCompleted': 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©',
        'tasksStatistics.noDataThisMonth': 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±',
        minutesShort: 'Ø¯',
        retry: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',
        // Employees statistics screen
        employeesStats: 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
        employeesStats_workHours: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„',
        employeesStats_tasksCompleted: 'Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©',
        employeesStats_lateTasks: 'Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©',
        employeesStats_taskLabel: 'Ù…Ù‡Ù…Ø©',
        employeesStats_taskPerformance: 'Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ù‡Ø§Ù…',
        employeesStats_onTime: 'ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯',
        employeesStats_late: 'Ù…ØªØ£Ø®Ø±Ø©',
        employeesStats_hoursBreakdown: 'ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¹Ø§Øª',
        employeesStats_taskHours: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù…',
        employeesStats_otherHours: 'Ø³Ø§Ø¹Ø§Øª Ø£Ø®Ø±Ù‰',
        employeesStats_total: 'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ',
        employeesStats_numberOfEmployees: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
        employeesStats_totalHours: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª',
        employeesStats_employeesHoursTotal: 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹)',
        employeesStats_tasksCompletedVsLate: 'Ø§Ù„Ù…Ù‡Ø§Ù…: Ù…ÙƒØªÙ…Ù„Ø© Ù…Ù‚Ø§Ø¨Ù„ Ù…ØªØ£Ø®Ø±Ø©',
        employeesStats_noDataThisMonth: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±',
        // Products / Materials statistics screen
        productsStats_materials: 'Ù…ÙˆØ§Ø¯',
        productsStats_usage: 'Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…',
        productsStats_additions: 'Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª',
        productsStats_usedLabel: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        productsStats_addedLabel: 'Ø§Ù„Ù…Ø¶Ø§Ù',
        productsStats_netLabel: 'Ø§Ù„ØµØ§ÙÙŠ',
        productsStats_usedMoney: 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        productsStats_addedMoney: 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§Ù',
        productsStats_netMoney: 'ØµØ§ÙÙŠ Ø¨Ø§Ù„Ù…Ø§Ù„',
        productsStats_detailsTitle: 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø©:',
        productsStats_unitPrice: 'Ø§Ù„Ø³Ø¹Ø± Ù„Ù„ÙˆØ­Ø¯Ø©',
        productsStats_usedAmount: 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        productsStats_addedAmount: 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù',
        productsStats_viewDetails: 'Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„',
        productsStats_share: 'Ù…Ø´Ø§Ø±ÙƒØ©',
        productsStats_retry: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',
        productsStats_noDataThisMonth: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±',
        productsStats_materialsLogTitle: 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø§Ø¯Ø©',
        productsStats_noLogs: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©',
        productsStats_typeAdded: 'Ù…Ø¶Ø§Ù',
        productsStats_typeUsed: 'Ù…Ø³ØªØ®Ø¯Ù…',
        // Dashboard / Admin panel
        dashboard_title: 'ðŸŽ‰ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„',
        dashboard_subtitle: 'Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø© ÙˆÙ…Ù…ØªØ¹Ø©',
        dashboard_restricted_title: 'ØµÙ„Ø§Ø­ÙŠØ§Øª',
        dashboard_restricted_text: 'Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Ø®ØµØµØ© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙÙ‚Ø·. Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø±Ø¤ÙŠØ© Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.',
        dashboard_tab_products: 'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
        dashboard_tab_employees: 'Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
        dashboard_tab_tasks: 'Ø§Ù„Ù…Ù‡Ø§Ù…',
        dashboard_date_label: 'Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø¯Ø¯',
        // month names
        month_jan: 'ÙŠÙ†Ø§ÙŠØ±',
        month_feb: 'ÙØ¨Ø±Ø§ÙŠØ±',
        month_mar: 'Ù…Ø§Ø±Ø³',
        month_apr: 'Ø£Ø¨Ø±ÙŠÙ„',
        month_may: 'Ù…Ø§ÙŠÙˆ',
        month_jun: 'ÙŠÙˆÙ†ÙŠÙˆ',
        month_jul: 'ÙŠÙˆÙ„ÙŠÙˆ',
        month_aug: 'Ø£ØºØ³Ø·Ø³',
        month_sep: 'Ø³Ø¨ØªÙ…Ø¨Ø±',
        month_oct: 'Ø£ÙƒØªÙˆØ¨Ø±',
        month_nov: 'Ù†ÙˆÙÙ…Ø¨Ø±',
        month_dec: 'Ø¯ÙŠØ³Ù…Ø¨Ø±',
    },
    en: {
        // Common
        login: 'Login',
        // Tasks statistics translations
        'tasksStatistics.title': 'Tasks Statistics',
        'tasksStatistics.assigned': 'Assigned',
        'tasksStatistics.doneOnTime': 'Done on time',
        'tasksStatistics.late': 'Late',
        'tasksStatistics.incomplete': 'Incomplete',
        'tasksStatistics.lateShort': 'Late',
        'tasksStatistics.completed': 'Completed',
        'tasksStatistics.averageDuration': 'Average duration',
        'tasksStatistics.duration': 'Assigned duration',
        'tasksStatistics.totalTasks': 'Total tasks',
        'tasksStatistics.timesAssigned': 'Times assigned',
        'tasksStatistics.timesCompleted': 'Times completed',
        'tasksStatistics.noDataThisMonth': 'No data for this month',
        minutesShort: 'm',
        retry: 'Retry',
        // New screens: employees hours
        employeesHoursTitle: 'Monthly Employee Hours',
        prevMonth: 'Previous Month',
        nextMonth: 'Next Month',
        selectMonth: 'Select month',
        noEmployeesData: 'No employee data available',
        // New labels for employees hours row
        worked: 'Worked',
        of: 'of',
        days: 'days',
        // Materials form translations
        noMaterialsData: 'No Materials',
        addMaterial: 'Add Material',
        name: 'Name',
        quantity: 'Quantity',
        minQuantity: 'Minimum Quantity',
        hebrewName: 'Hebrew Name',
        cost: 'Cost',
        // Label for last-updated datetime
        updated: 'Updated',
        selectUnit: 'Select Unit',
        selectMaterial: 'Select material',
        searchMaterials: 'Search materials...',
        materialGroups: 'Materials groups',
        // Materials list button/label
        materialsList: 'Materials list',
        // Added translations for update-material-quantity screen
        updateMaterialsQuantity: 'Update Materials Quantity',
        accessDenied: 'Access denied. Employees only.',
        invalidQuantity: 'Invalid quantity',
        failedToSave: 'Failed to save quantity',
        saved: 'Saved',
        // Saving status
        saving: 'Saving...',
        cancel: 'Cancel',
        add: 'Add',
        nameRequired: 'Name is required',
        hebrewNameRequired: 'Hebrew name is required',
        costRequired: 'Cost is required',
        failedToCreateMaterial: 'Failed to create material',
        low: 'Low',
        unit_kg: 'kg',
        unit_g: 'g',
        unit_pcs: 'pcs',
        unit_ltr: 'ltr',
        unit_pack: 'pack',
        unit_m: 'm',
        // Notifications/modal
        notifications: 'Notifications',
        markAllRead: 'Mark all as read',
        markRead: 'Mark as read',
        close: 'Close',
        // Edit/Delete
        editMaterial: 'Edit Material',
        save: 'Save',
        delete: 'Delete',
        deleteConfirm: 'Are you sure you want to delete this item?',
        employeeDetailsTitle: 'Employee Details',
        noWorkDays: 'No work days',
        startTime: 'Start Time',
        endTime: 'End Time',
        sunday: 'Sunday',
        monday: 'Monday',
        tuesday: 'Tuesday',
        wednesday: 'Wednesday',
        thursday: 'Thursday',
        friday: 'Friday',
        saturday: 'Saturday',
        idNumber: 'ID Number',
        password: 'Password',
        hide: 'Hide',
        show: 'Show',
        loginButton: 'Login',
        loginError: 'Login Error',
        adminDashboard: 'Admin Dashboard',
        employeeDashboard: 'Employee Dashboard',
        workingHours: 'Working Hours',
        clockIn: 'Clock In',
        clockOut: 'Clock Out',
        currentStatus: 'Current Status',
        clockedIn: 'Clocked In',
        clockedOut: 'Clocked Out',
        logout: 'Logout',
        confirmLogout: 'Are you sure you want to logout?',
        workingHoursToday: 'Working Hours Today',
        totalHours: 'Total Hours',
        workHistory: 'Work History',
        noWorkHistory: 'No work history',
        loading: 'Loading...',
        clockedInAt: 'Clocked in at:',
        confirmClockOut: 'Are you sure you want to clock out?',
        back: 'Back',
        error: 'Error',
        failedToClockIn: 'Failed to clock in',
        failedToClockOut: 'Failed to clock out',
        stillWorking: 'Still working',
        in: 'In:',
        out: 'Out:',
        // Back to groups (used in update-material-quantity screen)
        backToGroups: 'Back to groups',

        // Work Status screen
        workStatus: 'Work Status',
        noOneWorking: 'No employees are currently working on tasks.',
        startedAt: 'Started at',
        assignedDuration: 'Assigned duration',
        elapsed: 'Elapsed',

        // Add User screen
        confirmPassword: 'Confirm Password',
        role: 'Role',
        employee: 'Employee',
        admin: 'Admin',
        active: 'Active',
        addUser: 'Add User',
        addNewUser: 'Add New User',
        addUserSubtitle: 'Fill in the following data to create a user account',
        // Password change labels/messages
        newPassword: 'New password',
        passwordHelp: 'Leave blank to keep the current password. Minimum 6 characters.',
        passwordMinLength: 'Password must be at least 6 characters',
        passwordsDoNotMatch: 'Passwords do not match',
        // Users list / management
        manageUsers: 'Manage Users',
        edit: 'Edit',
        userListSubtitle: 'View and manage users',
        editUser: 'Edit User',
        // Placeholders and messages used by add-user.tsx
        enterUserName: 'Enter name',
        enterIdNumber: 'Enter ID number',
        enterPassword: 'Enter password',
        reEnterPassword: 'Re-enter password',
        success: 'Success',
        userAddedSuccessfully: 'User added successfully',
        ok: 'OK',
        failedToAddUser: 'Failed to add user',
        passwordsNotMatch: 'Passwords do not match',
        userCanLoginImmediately: 'User can login immediately',
        userCannotLogin: 'User cannot login',

        // Validation messages
        idNumberRequired: 'ID number is required',
        idNumberMin: 'ID number must be at least 3 characters',
        passwordRequired: 'Password is required',
        passwordMin: 'Password must be at least 6 characters',
        materialsManagement: 'Materials Management',

        // Task Groups
        taskGroups: 'Task Groups',
        groupName: 'Group Name',
        tasks: 'Tasks',
        taskName: 'Task Name',
        durationInMinutes: 'Duration (minutes)',
        startAt: 'Start At',
        description: 'Description',
        usedMaterials: 'Used Materials',
        producedMaterials: 'Produced Materials',
        addMaterialToTask: 'Add Material to Task',
        removeMaterialFromTask: 'Remove Material from Task',
        addTask: 'Add Task',
        removeTask: 'Remove Task',
        submit: 'Submit',
        noTaskGroups: 'No task groups yet',
        noTaskGroup: 'Task group not found',
        errorFetchingData: 'Error fetching data',
        remove: 'Remove',
        newTaskGroup: 'New Task Group',
        // New material group screen title
        newMaterialGroup: 'New Material Group',
        planWorkDay: 'Plan Work Day',
        change: 'Change',
        set: 'Set',
        employees: 'Employees',
        assignments: 'Assignments',
        noEmployeesSelected: 'No employees selected',
        savePlan: 'Save Plan',
        previousDay: 'Previous day',
        nextDay: 'Next day',
        selectDate: 'Select date',
        // Today tasks screen title
        todayTasks: "Today's Tasks",
        // Today tasks screen strings
        noTasksToday: "No tasks assigned for today.",
        start: 'Start',
        end: 'End',
        untitledTask: 'Untitled Task',
        overrunTitle: 'Task took longer than planned',
        overrunPrompt: 'Please enter a brief reason why this task took more time:',
        overrunPlaceholder: 'e.g. waiting on ingredients, machine downtime',
        notificationSent: 'Overrun notification sent to admins',
        notificationFailed: 'Notification failed',
        failedToSaveTaskTimes: 'Failed to save task times',
        planSaved: 'Plan saved',
        noResults: 'No results',
        clear: 'Clear',
        // Welcome overlay
        welcomeBackMain: 'Welcome back,',
        welcomeBackSub: `Ready to make today awesome? Let's go! ðŸŽ‰`,
        // Employees statistics screen
        employeesStats: 'Employees Statistics',
        employeesStats_workHours: 'Work hours',
        employeesStats_tasksCompleted: 'Tasks completed',
        employeesStats_lateTasks: 'Late tasks',
        employeesStats_taskLabel: 'task',
        employeesStats_taskPerformance: 'Task Performance',
        employeesStats_onTime: 'On time',
        employeesStats_late: 'Late',
        employeesStats_hoursBreakdown: 'Hours Breakdown',
        employeesStats_taskHours: 'Task hours',
        employeesStats_otherHours: 'Other hours',
        employeesStats_total: 'Total',
        employeesStats_numberOfEmployees: 'Number of employees',
        employeesStats_totalHours: 'Total hours',
        employeesStats_employeesHoursTotal: 'Employees hours (total)',
        employeesStats_tasksCompletedVsLate: 'Tasks: completed vs late',
        employeesStats_noDataThisMonth: 'No data for this month',
        // Products / Materials statistics screen
        productsStats_materials: 'Materials',
        productsStats_usage: 'Usage',
        productsStats_additions: 'Additions',
        productsStats_usedLabel: 'Used',
        productsStats_addedLabel: 'Added',
        productsStats_netLabel: 'Net',
        productsStats_usedMoney: 'Used value',
        productsStats_addedMoney: 'Added value',
        productsStats_netMoney: 'Net value',
        productsStats_detailsTitle: 'Material details:',
        productsStats_unitPrice: 'Unit price',
        productsStats_usedAmount: 'Used amount',
        productsStats_addedAmount: 'Added amount',
        productsStats_viewDetails: 'View details',
        productsStats_share: 'Share',
        productsStats_retry: 'Retry',
        productsStats_noDataThisMonth: 'No data for this month',
        productsStats_materialsLogTitle: 'Material log',
        productsStats_noLogs: 'No logs for this material',
        productsStats_typeAdded: 'Added',
        productsStats_typeUsed: 'Used',
        // Dashboard / Admin panel
        dashboard_title: 'ðŸŽ‰ Admin Dashboard',
        dashboard_subtitle: 'Quick, delightful statistics',
        dashboard_restricted_title: 'Permissions',
        dashboard_restricted_text: 'This area is for administrators only. You do not have access to view this screen. Please contact the administrator.',
        dashboard_tab_products: 'Products',
        dashboard_tab_employees: 'Employees',
        dashboard_tab_tasks: 'Tasks',
        dashboard_date_label: 'Selected date',
        // month names
        month_jan: 'January',
        month_feb: 'February',
        month_mar: 'March',
        month_apr: 'April',
        month_may: 'May',
        month_jun: 'June',
        month_jul: 'July',
        month_aug: 'August',
        month_sep: 'September',
        month_oct: 'October',
        month_nov: 'November',
        month_dec: 'December',
    }
};

type Lang = keyof typeof resources;

type I18nContextValue = {
    lang: Lang;
    setLang: (lng: Lang) => void;
    // Accept any string key to avoid strict typing errors in codebase where keys
    // may be added dynamically or missing from the small `resources` map.
    t: (key: string) => string;
};

const I18nContext = createContext<I18nContextValue | null>(null);

export function I18nProvider({children, defaultLang = 'ar' as Lang}: { children: ReactNode; defaultLang?: Lang }) {
    const [lang, setLang] = useState<Lang>(defaultLang);
    const value = useMemo<I18nContextValue>(() => ({
        lang,
        setLang,
        // Use any-indexing to lookup keys; fall back to the key string when missing.
        t: (key) => ((resources as any)[lang]?.[key] ?? String(key)) as string,
    }), [lang]);
    return createElement(I18nContext.Provider, {value}, children as any);
}

export function useTranslation() {
    const ctx = useContext(I18nContext);
    // Fallback to default Arabic if no provider is used
    const fallbackLang: Lang = 'ar';
    const fallbackT = (key: string) => ((resources as any)[fallbackLang]?.[key] ?? String(key)) as string;
    if (!ctx) return { t: fallbackT, lang: fallbackLang, setLang: (_lng: Lang) => { /* no-op without provider */ } };
    return { t: ctx.t, lang: ctx.lang, setLang: ctx.setLang };
}

export function setLanguage(lng: Lang) {
    // Convenience for non-React places if needed later (no-op without provider)
    // Consumers using the hook should prefer I18nProvider.
    console.warn('setLanguage called without provider; wrap app in <I18nProvider /> to enable dynamic language switching. Requested:', lng);
}

// Add a default export so the Expo/Next-style app router doesn't warn about a
// missing default export for this route file. Export a small wrapper component
// that simply renders the I18nProvider so if the router mounts this file it
// still provides i18n to its children.
export default function I18nRoute({children}: { children?: ReactNode }) {
    return createElement(I18nProvider, {children} as any);
}
